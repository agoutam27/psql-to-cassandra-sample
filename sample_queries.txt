count the number of rentals by staff per month: 
SELECT
    date_trunc('month', rental_date) m,
    COUNT (rental_id)
FROM
    rental
GROUP BY
    m
ORDER BY
    m;



SELECT group_and_count(rental_date, 'M-y') AS m FROM rental ;




count the number of rentals by staff per year: 

SELECT
 staff_id,
 date_trunc('year', rental_date) y,
 COUNT (rental_id) rental
FROM
 rental
GROUP BY
 staff_id, y
ORDER BY
 staff_id ;


SELECT staff_id, group_and_count(rental_date, 'Y') AS y, COUNT(rental_id) AS count FROM rental GROUP BY staff_id;


average rental rate by film category:

SELECT
    NAME,
    TRUNC(AVG( rental_rate ),2)
FROM
    film
INNER JOIN film_category
        USING(film_id)
INNER JOIN category
        USING(category_id)
GROUP BY
    NAME
ORDER BY NAME;


SELECT category, AVG(rental_rate) FROM film GROUP BY category;




top 10 rentals that have the longest durations: 

SELECT rental_id,
         customer_id,
         AGE(return_date,
             rental_date) AS duration
FROM rental
WHERE return_date IS NOT NULL
ORDER BY  duration DESC 
LIMIT 10;


SELECT topItems(rental_age, 10) FROM rental_by_duration;

SELECT rental_age, rental_id, customer_id FROM rental_by_duration WHERE rental_age IN (798900, 798900, 798960, 798960, 799080, 799080, 799080, 799080, 799140, 799140);